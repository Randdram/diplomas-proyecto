<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title or "ğŸ“ Portal Escolar Â· VerificaciÃ³n de Diplomas" }}</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <script>
    function updateAction(input) {
        const form = input.form;
        const folio = input.value.trim();
        if (folio) {
            form.action = `/verificar/${encodeURIComponent(folio)}`;
        } else {
            form.action = '/verificar';
        }
    }
    
    function handleFolioSubmit(event) {
        event.preventDefault();
        const form = event.target;
        const folioInput = form.querySelector('input[name="folio"]');
        const folio = folioInput.value.trim();
        
        if (folio) {
            window.location.href = `/verificar/${encodeURIComponent(folio)}`;
        }
    }
  </script>
</head>
<body>
  <div class="background-animation"></div>
  
  <nav class="nav">
    <div class="wrap">
      <div class="brand">
        <div class="logo">ğŸ“</div>
        <div class="title">PortalEscolar</div>
      </div>
      <div class="links">
        <a href="/ingresar">ğŸ‘¤ Alumnos</a>
        <a href="/docs" target="_blank" rel="noopener">ğŸ”§ API</a>
      </div>
    </div>
  </nav>

  <main class="wrap">
    <section class="hero floating">
      <h1>VerificaciÃ³n de Diplomas</h1>
      <p>ğŸ‰ Consulta, valida y descarga tus reconocimientos acadÃ©micos</p>
    </section>

    <!-- Verificar por folio -->
    <section class="card">
      <h3>ğŸ” Verificar por folio</h3>
      <form onsubmit="handleFolioSubmit(event)" style="display: flex; gap: 10px; align-items: center;">
        <input
          type="text"
          name="folio"
          placeholder="ğŸ“ Escribe tu folio aquÃ­..."
          required
          style="flex: 1;"
          oninput="updateAction(this)"
        />
        <button class="btn brand" type="submit">âœ¨ Verificar</button>
      </form>
      <p class="muted" style="margin-top: 10px;">Ejemplo: 7cdf9138-0bb2-4d4f-8100-175b40b220b8</p>
    </section>

    <!-- Acceso alumnos -->
    <section class="card">
      <h3>ğŸ‘¥ Portal de Alumnos</h3>
      <p>Â¿No recuerdas tu folio? Entra con tu CURP y descarga tus diplomas.</p>
      <a class="btn brand" href="/ingresar">ğŸš€ Entrar al Portal</a>
    </section>

    <!-- Herramientas admin -->
    {% if token %}
    <section class="card">
      <h3>ğŸ› ï¸ Herramientas de AdministraciÃ³n</h3>
      <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a class="btn" href="/admin/generar?token={{ token }}">ğŸ“„ Generar PDFs</a>
        <a class="btn" href="/admin/sync-auto?token={{ token }}">ğŸ”„ SincronizaciÃ³n AutomÃ¡tica</a>
        <a class="btn" href="/admin/sync?token={{ token }}">â˜ï¸ Sincronizar Supabase</a>
        <a class="btn" href="/pdfs-list">ğŸ“‹ Ver Ãndice</a>
      </div>
      <p class="muted">ğŸ”’ Solo visible con token de administrador vÃ¡lido</p>
    </section>
    {% endif %}
  </main>

  <footer>
    <div class="wrap">
      <small>Â© {{ (now or 2025) }} Portal Escolar Â· VerificaciÃ³n de Diplomas Â· Hecho con â¤ï¸</small>
      {% if token %}
      <br><small class="muted">Token: {{ token[:8] }}... (Admin activo)</small>
      {% endif %}
    </div>
  </footer>
</body>
</html>