<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>🛠️ Panel de Administración</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div class="background-animation"></div>
  
  <nav class="nav">
    <div class="wrap">
      <div class="brand">
        <div class="logo">🛠️</div>
        <div class="title">Panel Admin</div>
      </div>
      <div class="links">
        <a href="/" class="muted">👤 Portal Alumnos</a>
        <a href="/admin-logout" class="muted">🚪 Cerrar Sesión</a>
      </div>
    </div>
  </nav>

  <main class="wrap">
    <section class="hero">
      <h1>Panel de Administración</h1>
      <p>Sistema completo de gestión de diplomas</p>
    </section>

    <!-- Carga masiva de alumnos por CSV -->
    <section class="card">
      <h3>⬆️ Carga Masiva de Alumnos por CSV</h3>
      <p class="muted" style="margin-bottom: 1.5rem;">Sube un archivo CSV con las columnas: <strong>nombre, curp, escuela_id, grado_id, profesor_id</strong>.</p>
      <form method="post" enctype="multipart/form-data" action="/admin/upload-alumnos?token={{ token }}">
        <div class="grid-form">
          <input type="file" name="file" required accept=".csv" style="background: transparent; border: none; padding: 0.5rem 0;">
          <button class="btn brand" type="submit">Cargar Alumnos</button>
        </div>
      </form>
    </section>

    <!-- Generación de Diplomas desde la web -->
    <section class="card">
      <h3>📄 Generación de Diplomas por Curso</h3>
      <p class="muted" style="margin-bottom: 1.5rem;">Introduce el ID del curso para generar todos sus diplomas. El proceso se ejecutará en segundo plano.</p>
      <form method="post" action="/admin/generar-diplomas-action?token={{ token }}">
        <div class="grid-form">
          <input type="number" name="curso_id" placeholder="ID del Curso" required>
          <button class="btn brand" type="submit">Iniciar Generación</button>
        </div>
      </form>
    </section>

    <!-- Información del sistema -->
    <section class="card" style="background: rgba(255,255,255,0.05);">
      <h3>📈 Estado del Sistema</h3>
      <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1.5rem; text-align: center;">
        <div class="stat-item">
          <span style="font-size: 2rem; font-weight: 700; display: block;">{{ total_alumnos or '0' }}</span>
          <span style="font-size: 0.9rem; color: var(--text-secondary);">Alumnos Registrados</span>
        </div>
        <div class="stat-item">
          <span style="font-size: 2rem; font-weight: 700; display: block;">{{ total_cursos or '0' }}</span>
          <span style="font-size: 0.9rem; color: var(--text-secondary);">Cursos Activos</span>
        </div>
        <div class="stat-item">
          <span style="font-size: 2rem; font-weight: 700; display: block;">{{ total_diplomas or '0' }}</span>
          <span style="font-size: 0.9rem; color: var(--text-secondary);">Diplomas Generados</span>
        </div>
        <div class="stat-item">
          <span style="font-size: 2rem; font-weight: 700; display: block;">{{ sistema_estado or '–' }}</span>
          <span style="font-size: 0.9rem; color: var(--text-secondary);">Estado del Sistema</span>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="wrap">
      <small>© {{ now or '2025' }} Panel de Administración · Sesión activa para <strong>{{ admin_username }}</strong></small>
    </div>
  </footer>

</body>
</html>

